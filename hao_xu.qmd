---
title: "hao_xu"
author: "Hao Xu"
format: html
---

```{r}
library(here) 
library(readr)  
library(dplyr)
library(ggplot2)
library(tidyr)
library(knitr)  
here::i_am("grades.Rproj")
```
# 1 Personalisation and data set import
## Question1
```{r}
courses <- read_csv(here("data", "courses.csv"))
```
## Question 2
```{r}
courses |>
  arrange(course) |>
  rename(
    "course name" = course,
    "identifier" = course_id,
    "module" = module,
    "number of exams" = nb_grades  
  ) |>
  kable()
```

## Question3
```{r}
students <- read_csv(
  here("data", "students.csv"),
  col_types = cols(
    id = col_integer(),
    group = col_factor(),
    birth_date = col_date(),
    sex = col_factor()
  )
)
```

## Question4
```{r}
grades <- read_delim(
  here("data", "grades.csv"),
  delim = ":",      
  na = "_",         
  col_types = cols( 
    id = col_integer(),
    course_id = col_integer(),
    grade = col_double()
  )
)
```

# 2 Student population analysis
## Question5
```{r}
ggplot(students, aes(x = group)) +
  geom_bar()
```
## Question6
```{r}
ggplot(students, aes(x = group, fill = sex)) +
  geom_bar(position = "fill")
```
## Question7
```{r}
library(lubridate)
students <- students |>
  mutate(
    raw_age = time_length(today() - birth_date, unit = "year"),
    age = raw_age
  )
```

```{r}
ggplot(students, aes(x = age)) +
  geom_density(bw = "sj", fill = "skyblue", alpha = 0.5) +
  geom_rug(alpha = 0.5) 
```
## Question8
```{r}
students |>
  group_by(group) |>
  summarise(
    median_age = as.integer(round(median(age)))
  ) |>
  kable(
    col.names = c("Group", "Median Age (Integer)"),
    caption = "Median Age of Students by Group"
  )
```

